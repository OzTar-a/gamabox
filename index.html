<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÂéüÂàù‰πãÊòü & Á∂ìÈ©óË®àÁÆó</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'Segoe UI', 'Microsoft JhengHei', sans-serif;
            line-height: 1.6;
            background-color: #f0f2f5;
            color: #333;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .container { width: 90%; max-width: 1000px; margin: 0 auto; }

        header {
            background-color: #2c3e50;
            color: #fff;
            padding: 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        header .container {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .logo-area {
            padding: 1rem 0;
            font-size: 1.5rem;
            font-weight: bold;
        }

        .nav-tabs {
            display: flex;
            width: 100%;
            max-width: 600px;
            list-style: none;
            margin-bottom: -2px;
        }

        .nav-tabs li { flex: 1; text-align: center; }

        .nav-tabs a {
            display: block;
            padding: 15px 0;
            color: #bdc3c7;
            text-decoration: none;
            font-weight: 600;
            border-bottom: 4px solid transparent;
            transition: all 0.3s;
            cursor: pointer;
        }

        .nav-tabs a:hover {
            color: #ecf0f1;
            background-color: rgba(255,255,255,0.05);
        }

        .nav-tabs a.active {
            color: #fff;
            border-bottom: 4px solid #e74c3c;
        }

        main { flex: 1; padding: 40px 0; }

        .tab-content { display: none; animation: fadeIn 0.3s ease-in-out; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- Âç°ÁâáÈÄöÁî®Ê®£Âºè --- */
        .tool-card {
            background: #fff;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.12);
            overflow: hidden;
            max-width: 800px;
            margin: 0 auto;
        }

        .card-header {
            background: #34495e;
            color: #fff;
            padding: 20px;
            text-align: center;
        }
        .card-header h2 { margin: 0; font-size: 1.5rem; }
        .card-header p { opacity: 0.8; font-size: 0.9rem; margin-top: 5px; }

        .card-body { padding: 30px; }

        .form-group { margin-bottom: 20px; }
        .form-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #2c3e50; font-size: 0.95rem; }
        
        .season-select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #3498db;
            border-radius: 8px;
            font-size: 1rem;
            background-color: #fcfcfc;
            color: #2c3e50;
            font-weight: bold;
            outline: none;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 20px;
        }
        .season-select:hover {
            background-color: #f0f8ff;
        }

        .form-group input,
        .simple-view input {
            width: 100%; 
            padding: 12px 15px; 
            border: 2px solid #e0e0e0;
            border-radius: 8px; 
            font-size: 1rem; 
            outline: none; 
            transition: border-color 0.3s;
            background: #fff;
        }
        
        .form-group input:focus,
        .simple-view input:focus { 
            border-color: #3498db; 
        }

        .row-group { display: flex; gap: 15px; }
        .row-group .form-group { flex: 1; margin-bottom: 0; }

        .category-section {
            background: #fafafa;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            position: relative;
        }

        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e0e0;
        }

        .category-title {
            font-size: 1.1rem;
            font-weight: bold;
            color: #2c3e50;
            display: flex;
            align-items: center;
        }
        
        .category-title::before {
            content: '';
            display: inline-block;
            width: 4px;
            height: 18px;
            background: #3498db;
            margin-right: 10px;
            border-radius: 2px;
        }

        .toggle-wrapper {
            display: flex;
            align-items: center;
        }
        
        .toggle-label {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-size: 0.85rem;
            color: #7f8c8d;
            font-weight: 600;
        }

        .switch {
            position: relative;
            display: inline-block;
            width: 40px;
            height: 20px;
            margin-left: 8px;
        }

        .switch input { opacity: 0; width: 0; height: 0; }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0; left: 0; right: 0; bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 14px; width: 14px;
            left: 3px; bottom: 3px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider { background-color: #e74c3c; }
        input:checked + .slider:before { transform: translateX(20px); }

        .hidden { display: none !important; }
        
        .grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; }
        .grid-5 { display: grid; grid-template-columns: repeat(5, 1fr); gap: 8px; }
        
        .detail-item {
            min-width: 0; 
        }

        .detail-item label {
            font-size: 0.75rem;
            color: #7f8c8d;
            margin-bottom: 2px;
            display: block;
            white-space: nowrap; 
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* Ë©≥Á¥∞Ê®°ÂºèÂ∞èÊ†ºÂ≠êÊ®£Âºè */
        .detail-item input {
            width: 100%; 
            padding: 8px;
            font-size: 0.9rem;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            outline: none;
            background: #fff;
            transition: border-color 0.3s;
        }
        
        .detail-item input:focus {
            border-color: #3498db;
        }

        .relic-group {
            margin-bottom: 15px;
        }
        .relic-group-title {
            font-size: 0.85rem;
            font-weight: bold;
            color: #666;
            margin-bottom: 5px;
            padding-left: 5px;
            border-left: 3px solid #bdc3c7;
        }

        .result-box {
            background: linear-gradient(135deg, #2c3e50 0%, #3498db 100%);
            color: #fff;
            padding: 25px;
            border-radius: 8px;
            margin-top: 30px;
            text-align: center;
        }
        .result-item {
            margin: 15px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255,255,255,0.2);
            padding-bottom: 10px;
        }
        .result-item:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }
        
        .result-label { font-size: 1.1rem; opacity: 0.9; }
        .result-value { font-size: 1.5rem; font-weight: bold; color: #f1c40f; text-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        
        .time-result { font-size: 1.8rem; color: #f1c40f; font-weight: bold; display: block; margin-top: 10px; }
        .sub-result-label { font-size: 0.95rem; opacity: 0.8; display: block; margin-bottom: 5px;}
        .sub-result-value { font-size: 1.2rem; color: #ecf0f1; font-weight: 600; }
        .note { font-size: 0.85rem; color: #7f8c8d; text-align: center; margin-top: 15px; }

        footer { background: #2c3e50; color: #bdc3c7; text-align: center; padding: 20px 0; font-size: 0.9rem; margin-top: auto; }

        @media (max-width: 600px) {
            .row-group { flex-direction: column; gap: 20px; }
            .grid-4, .grid-5 { grid-template-columns: repeat(2, 1fr); }
            .category-title { font-size: 1rem; }
        }
    </style>
</head>
<body>

    <header>
        <div class="container">
            <div class="logo-area"></div>
            <ul class="nav-tabs">
                <li><a class="active" onclick="switchTab('tab-star')">ÂéüÂàù‰πãÊòü</a></li>
                <li><a onclick="switchTab('tab-exp')">Á∂ìÈ©óË®àÁÆó</a></li>
            </ul>
        </div>
    </header>

    <main>
        <div class="container">
            
            <div id="tab-star" class="tab-content active">
                <div class="tool-card">
                    <div class="card-header">
                        <h2>üèÜ Ë≥ΩÂ≠£Á≠âÁ¥öË®àÁÆóÊ©ü</h2>
                        <p>Ëº∏ÂÖ•ËßíËâ≤Êï∏ÊìöÔºåÈ†êÊ∏¨ÂéüÂàù‰πãÊòüË©ïÂàÜ</p>
                    </div>
                    <div class="card-body">
                        
                        <select id="seasonSelect" class="season-select" onchange="handleSeasonChange()">
                            <option value="S1">S1. ÈÄ¢È≠îÊôÇÂàª</option>
                            <option value="S2">S2. Ê∑µËôπÈÇÇÁæΩ</option>
                            <option value="S3">S3. Ê∏æÊ≤åÁµÇÁÑâ</option>
                        </select>

                        <div class="form-group">
                            <label for="charLevel">ËßíËâ≤Á≠âÁ¥ö (Lv)</label>
                            <input type="number" id="charLevel" placeholder="100-260">
                        </div>

                        <div class="form-group">
                            <label>Áï∂ÂâçÁ∂ìÈ©ó</label>
                            <input type="number" id="currentExp" placeholder="0">
                            <p class="note" style="text-align: left; margin-top: 5px; font-size: 0.8rem;">
                                * Á∂ìÈ©ó‰∏äÈôêÂ∞áËá™ÂãïÂ∏∂ÂÖ•ÔºõÊîØÊè¥Êô∫ÊÖßËº∏ÂÖ• (Â¶Ç 12.6 = 126,000)
                            </p>
                        </div>

                        <hr style="border: 0; border-top: 1px solid #eee; margin: 25px 0;">

                        <div class="category-section" id="section-skill">
                            <div class="category-header">
                                <div class="category-title">ÊäÄËÉΩÁ≠âÁ¥ö</div>
                                <div class="toggle-wrapper">
                                    <label class="toggle-label">
                                        Ë©≥Á¥∞Ëº∏ÂÖ•
                                        <label class="switch">
                                            <input type="checkbox" id="toggle-skill" onchange="toggleSection('skill')">
                                            <span class="slider"></span>
                                        </label>
                                    </label>
                                </div>
                            </div>
                            <div class="simple-view">
                                <input type="number" id="avgSkill" class="calc-input" placeholder="Ëº∏ÂÖ•Âπ≥ÂùáÁ≠âÁ¥ö">
                            </div>
                            <div class="detail-view hidden">
                                <div class="relic-group-title">‰∏ªÂãïÊäÄËÉΩ</div>
                                <div class="grid-4" style="margin-bottom: 10px;">
                                    <div class="detail-item"><input type="number" class="detail-input skill-detail" placeholder="‰∏ªÂãï1"></div>
                                    <div class="detail-item"><input type="number" class="detail-input skill-detail" placeholder="‰∏ªÂãï2"></div>
                                    <div class="detail-item"><input type="number" class="detail-input skill-detail" placeholder="‰∏ªÂãï3"></div>
                                    <div class="detail-item"><input type="number" class="detail-input skill-detail" placeholder="‰∏ªÂãï4"></div>
                                </div>
                                <div class="relic-group-title">Ë¢´ÂãïÊäÄËÉΩ</div>
                                <div class="grid-4">
                                    <div class="detail-item"><input type="number" class="detail-input skill-detail" placeholder="Ë¢´Âãï1"></div>
                                    <div class="detail-item"><input type="number" class="detail-input skill-detail" placeholder="Ë¢´Âãï2"></div>
                                    <div class="detail-item"><input type="number" class="detail-input skill-detail" placeholder="Ë¢´Âãï3"></div>
                                    <div class="detail-item"><input type="number" class="detail-input skill-detail" placeholder="Ë¢´Âãï4"></div>
                                </div>
                            </div>
                        </div>

                        <div class="category-section" id="section-equip">
                            <div class="category-header">
                                <div class="category-title">Ë£ùÂÇôÁ≠âÁ¥ö</div>
                                <div class="toggle-wrapper">
                                    <label class="toggle-label">
                                        Ë©≥Á¥∞Ëº∏ÂÖ•
                                        <label class="switch">
                                            <input type="checkbox" id="toggle-equip" onchange="toggleSection('equip')">
                                            <span class="slider"></span>
                                        </label>
                                    </label>
                                </div>
                            </div>
                            <div class="simple-view">
                                <input type="number" id="avgEquip" class="calc-input" placeholder="Ëº∏ÂÖ•Âπ≥ÂùáÁ≠âÁ¥ö">
                            </div>
                            <div class="detail-view hidden">
                                <div class="grid-5">
                                    <div class="detail-item"><label>Ê≠¶Âô®</label><input type="number" class="detail-input equip-detail"></div>
                                    <div class="detail-item"><label>ÂâØÊ≠¶</label><input type="number" class="detail-input equip-detail"></div>
                                    <div class="detail-item"><label>Â∏ΩÂ≠ê</label><input type="number" class="detail-input equip-detail"></div>
                                    <div class="detail-item"><label>Ë°£Êúç</label><input type="number" class="detail-input equip-detail"></div>
                                    <div class="detail-item"><label>ÈûãÂ≠ê</label><input type="number" class="detail-input equip-detail"></div>
                                </div>
                            </div>
                        </div>

                        <div class="category-section" id="section-pal">
                            <div class="category-header">
                                <div class="category-title">ÂπªÁç∏Á≠âÁ¥ö</div>
                                <div class="toggle-wrapper">
                                    <label class="toggle-label">
                                        Ë©≥Á¥∞Ëº∏ÂÖ•
                                        <label class="switch">
                                            <input type="checkbox" id="toggle-pal" onchange="toggleSection('pal')">
                                            <span class="slider"></span>
                                        </label>
                                    </label>
                                </div>
                            </div>
                            <div class="simple-view">
                                <input type="number" id="avgPal" class="calc-input" placeholder="Ëº∏ÂÖ•Âπ≥ÂùáÁ≠âÁ¥ö">
                            </div>
                            <div class="detail-view hidden">
                                <div class="grid-4">
                                    <div class="detail-item"><label>Âá∫Êà∞</label><input type="number" class="detail-input pal-detail"></div>
                                    <div class="detail-item"><label>ËºîÂä©1</label><input type="number" class="detail-input pal-detail"></div>
                                    <div class="detail-item"><label>ËºîÂä©2</label><input type="number" class="detail-input pal-detail"></div>
                                    <div class="detail-item"><label>ËºîÂä©3</label><input type="number" class="detail-input pal-detail"></div>
                                </div>
                            </div>
                        </div>

                        <div class="category-section" id="section-relic">
                            <div class="category-header">
                                <div class="category-title">ÈÅ∫Áâ©Á≠âÁ¥ö</div>
                                <div class="toggle-wrapper">
                                    <label class="toggle-label">
                                        Ë©≥Á¥∞Ëº∏ÂÖ•
                                        <label class="switch">
                                            <input type="checkbox" id="toggle-relic" onchange="toggleSection('relic')">
                                            <span class="slider"></span>
                                        </label>
                                    </label>
                                </div>
                            </div>
                            <div class="simple-view">
                                <input type="number" id="avgRelic" class="calc-input" placeholder="Ëº∏ÂÖ•Âπ≥ÂùáÁ≠âÁ¥ö">
                            </div>
                            <div class="detail-view hidden">
                                <div class="relic-group">
                                    <div class="relic-group-title">ÂÖâÈÅ∫Áâ©</div>
                                    <div class="grid-4">
                                        <div class="detail-item"><input type="number" class="detail-input relic-detail" placeholder="1"></div>
                                        <div class="detail-item"><input type="number" class="detail-input relic-detail" placeholder="2"></div>
                                        <div class="detail-item"><input type="number" class="detail-input relic-detail" placeholder="3"></div>
                                        <div class="detail-item"><input type="number" class="detail-input relic-detail" placeholder="4"></div>
                                    </div>
                                </div>
                                <div class="relic-group">
                                    <div class="relic-group-title">ÊöóÈÅ∫Áâ©</div>
                                    <div class="grid-4">
                                        <div class="detail-item"><input type="number" class="detail-input relic-detail" placeholder="1"></div>
                                        <div class="detail-item"><input type="number" class="detail-input relic-detail" placeholder="2"></div>
                                        <div class="detail-item"><input type="number" class="detail-input relic-detail" placeholder="3"></div>
                                        <div class="detail-item"><input type="number" class="detail-input relic-detail" placeholder="4"></div>
                                    </div>
                                </div>
                                <div class="relic-group">
                                    <div class="relic-group-title">È¢®ÈÅ∫Áâ©</div>
                                    <div class="grid-4">
                                        <div class="detail-item"><input type="number" class="detail-input relic-detail" placeholder="1"></div>
                                        <div class="detail-item"><input type="number" class="detail-input relic-detail" placeholder="2"></div>
                                        <div class="detail-item"><input type="number" class="detail-input relic-detail" placeholder="3"></div>
                                        <div class="detail-item"><input type="number" class="detail-input relic-detail" placeholder="4"></div>
                                    </div>
                                </div>
                                <div class="relic-group">
                                    <div class="relic-group-title">Ê∞¥ÈÅ∫Áâ©</div>
                                    <div class="grid-4">
                                        <div class="detail-item"><input type="number" class="detail-input relic-detail" placeholder="1"></div>
                                        <div class="detail-item"><input type="number" class="detail-input relic-detail" placeholder="2"></div>
                                        <div class="detail-item"><input type="number" class="detail-input relic-detail" placeholder="3"></div>
                                        <div class="detail-item"><input type="number" class="detail-input relic-detail" placeholder="4"></div>
                                    </div>
                                </div>
                                <div class="relic-group">
                                    <div class="relic-group-title">ÁÅ´ÈÅ∫Áâ©</div>
                                    <div class="grid-4">
                                        <div class="detail-item"><input type="number" class="detail-input relic-detail" placeholder="1"></div>
                                        <div class="detail-item"><input type="number" class="detail-input relic-detail" placeholder="2"></div>
                                        <div class="detail-item"><input type="number" class="detail-input relic-detail" placeholder="3"></div>
                                        <div class="detail-item"><input type="number" class="detail-input relic-detail" placeholder="4"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="result-box">
                            <div class="result-item">
                                <span class="result-label">Á∏ΩÂàÜ</span>
                                <span id="star-totalScore" class="result-value">0</span>
                            </div>
                            <div class="result-item">
                                <span class="result-label">ÂéüÂàù‰πãÊòü</span>
                                <span id="star-final" class="result-value">10.00</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div id="tab-exp" class="tab-content">
                <div class="tool-card">
                    <div class="card-header">
                        <h2>‚è≥ ÂçáÁ¥öÊôÇÈñìË®àÁÆó</h2>
                        <p>Ë®àÁÆóÊéõÊ©üÊâÄÈúÄÊôÇÈñìÔºåÂåÖÂê´Âä†ÈÄüÈÅìÂÖ∑ÊäòÊäµ</p>
                    </div>
                    <div class="card-body">
                        <!-- Âü∫Á§éËº∏ÂÖ• -->
                        <div class="form-group row-group">
                            <div class="form-group">
                                <label>ÁèæÂú®Á≠âÁ¥ö</label>
                                <input type="number" id="exp-currentLv" placeholder="‰æãÂ¶Ç 100">
                            </div>
                            <div class="form-group">
                                <label>ÁõÆÊ®ôÁ≠âÁ¥ö</label>
                                <input type="number" id="exp-targetLv" placeholder="‰æãÂ¶Ç 120">
                            </div>
                        </div>

                        <div class="form-group">
                            <label>ÁèæÂú®Â∑≤Á¥ØÁ©çÁ∂ìÈ©ó</label>
                            <input type="number" id="exp-currentExp" placeholder="0">
                            <p class="note" style="text-align: left; margin-top: 5px; font-size: 0.8rem;">
                                * ÊîØÊè¥Êô∫ÊÖßËº∏ÂÖ• (Â¶Ç 12.6 = 126,000)
                            </p>
                        </div>

                        <div class="form-group">
                            <label>ÊØèÂ∞èÊôÇÁ∂ìÈ©ó (Exp/Hr)</label>
                            <input type="number" id="exp-perHour" placeholder="‰æãÂ¶Ç 350000">
                        </div>

                        <div class="form-group row-group">
                            <div class="form-group">
                                <label>ÂÖçË≤ªÂä†ÈÄü (Ê¨°)</label>
                                <input type="number" id="exp-freeSpeedup" placeholder="Ê¨°Êï∏">
                            </div>
                            <div class="form-group">
                                <label>Âä†ÈÄüÁü≥È†≠ (È°Ü)</label>
                                <input type="number" id="exp-stoneSpeedup" placeholder="Ê¨°Êï∏">
                            </div>
                        </div>
                        <p class="note" style="margin-bottom: 20px; text-align: left;">* Ë®ªÔºöÊØèÊ¨°Âä†ÈÄüÂùá‰ª• 2 Â∞èÊôÇÁ∂ìÈ©óË®àÁÆó</p>

                        <div class="result-box">
                            <div style="margin-bottom: 20px;">
                                <span class="result-label">È†êË®àÊâÄÈúÄÊôÇÈñì (Âê´Âä†ÈÄü)</span>
                                <span id="exp-timeResult" class="time-result">0Â§© 0Â∞èÊôÇ 0ÂàÜ</span>
                            </div>
                            <div style="border-top: 1px solid rgba(255,255,255,0.3); padding-top: 15px;">
                                <span class="sub-result-label">Ëã•ÂÆåÂÖ®‰∏ç‰ΩøÁî®Âä†ÈÄüÈÅìÂÖ∑</span>
                                <span id="exp-timeResult-original" class="sub-result-value">0Â§© 0Â∞èÊôÇ 0ÂàÜ</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </main>

    <footer>
        <p>&copy; 2024 GameGuide. Êï∏ÊìöËàáÂúñÁâáÂÉÖ‰æõÂèÉËÄÉ.</p>
    </footer>

    <script>
        function switchTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-tabs a').forEach(el => el.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            event.target.classList.add('active');
        }

        function toggleSection(sectionName) {
            const toggle = document.getElementById(`toggle-${sectionName}`);
            const section = document.getElementById(`section-${sectionName}`);
            const simpleView = section.querySelector('.simple-view');
            const detailView = section.querySelector('.detail-view');

            if (toggle.checked) {
                simpleView.classList.add('hidden');
                detailView.classList.remove('hidden');
            } else {
                simpleView.classList.remove('hidden');
                detailView.classList.add('hidden');
            }
            calculateStar();
        }
        const expTableS1 = {
            100: 886086, 101: 888547, 102: 926501, 103: 964086, 104: 1012164,
            105: 1054111, 106: 1096529, 107: 1135645, 108: 1174997, 109: 1214584,
            110: 1258533, 111: 1303677, 112: 1348574, 113: 1393941, 114: 1439780,
            115: 1486091, 116: 1532872, 117: 1580125, 118: 1627849, 119: 1676044,
            120: 1730017, 121: 1783360, 122: 1833196, 123: 1833196, 124: 1833196,
            125: 1833196, 126: 1833196, 127: 1833196, 128: 1833196, MAX_VAL: 1833196 
        };

        const expTableS2 = {
            100: 886000, 101: 3027527, 102: 3032011, 103: 3117883, 104: 3191855,
            105: 3220513, 106: 3258763, 107: 3346658, 108: 3389858, 109: 3548753,
            110: 3631694, 111: 3771824, 112: 3796167, 113: 3866624, 114: 3924404,
            115: 4029348, 116: 4101565, 117: 4245434, 118: 4245686, 119: 4514881,
            120: 4566377, 121: 4752888, 122: 4860000, 123: 5012377, 124: 5016341,
            125: 5178619, 126: 5229563, 127: 5423881, 128: 5459728, 129: 6335318,
            130: 6342809, 131: 6791971, 132: 7349165, 133: 7896724, 134: 8431041,
            135: 8948504, 136: 9536985, 137: 10062872, 138: 10591166, 139: 11201308,
            140: 11280750, 141: 11334730, 142: 11387696, 143: 11440662, 144: 11493628,
            145: 11546594, 146: 11599560, 147: 11652526, 148: 11679009, 149: 11731975,
            150: 11784941, 151: 11811613, 152: 11838097, 153: 11864580, 154: 11917547,
            155: 11970514, 156: 12049964, 157: 12155898, 158: 12208865, 159: 12261832,
            160: 12314799, 161: 12394079, 162: 12447046, 163: 12500012, 164: 12500012,
            165: 12526495, 166: 12579461, 167: 12632427, 168: 12658910, 169: 12711876,
            170: 12764842, 171: 12817637, 172: 12870602, 173: 12950050, 174: 13029499,
            175: 13082464, 176: 13135429, 177: 13188395, 178: 13214878, 179: 13267843,
            180: 13320809, 181: 13372809, 182: 13399290, 183: 13425771, 184: 13452251,
            185: 13478732, 186: 13478732, 187: 13478732, 188: 13478732, MAX_VAL: 13478732
        };
        const expTableS3 = {
            100: 886000, 101: 3027527, 102: 3032011, 103: 3117883, 104: 3191855,
            105: 3220513, 106: 3258763, 107: 3346658, 108: 3389858, 109: 3548753,
            110: 3631694, 111: 3771824, 112: 3796167, 113: 3866624, 114: 3924404,
            115: 4029348, 116: 4101565, 117: 4245434, 118: 4245686, 119: 4514881,
            120: 4566377, 121: 4752888, 122: 4860000, 123: 5012377, 124: 5016341,
            125: 5178619, 126: 5229563, 127: 5423881, 128: 5459728, 129: 6335318,
            
            // Lv 130 Ëµ∑ËÆäÂãï (S3 Êñ∞Êï∏Êìö)
            130: 22859655, 131: 23541185, 132: 23587156, 133: 24290510, 134: 24337860,
            135: 25112507, 136: 25161277, 137: 25962089, 138: 26062556, 139: 26920314,
            140: 27780149, 141: 28608441, 142: 28773140, 143: 29687769, 144: 29800863,
            145: 30864506, 146: 30980992, 147: 32025290, 148: 32205262, 149: 33270698,
            150: 34387276, 151: 35609150, 152: 35871344, 153: 37143639, 154: 37211154,
            155: 38460179, 156: 38529719, 157: 39822474, 158: 40037353, 159: 43248083,
            160: 44969859, 161: 48762878, 162: 52604320, 163: 56396556, 164: 60225668,
            165: 63980989, 166: 67994521, 167: 71934262, 168: 76039985, 169: 80194876,
            170: 80600630, 171: 81009637, 172: 81415408, 173: 81685922, 174: 81821179,
            175: 82226950, 176: 82632720, 177: 82903234, 178: 83309005, 179: 83714776,
            180: 83985290, 181: 84388130, 182: 84658635, 183: 84929139, 184: 85334896,
            185: 85605400, 186: 85875905, 187: 86281661, 188: 86552166, 189: 86822670,
            190: 86957923, 191: 87237117, 192: 87507648, 193: 87913445, 194: 103526684,
            195: 114131779, 196: 114434891, 197: 114586448, 198: 114889559, 199: 115192672,
            200: 115344229, 201: 115928916, 202: 116231965, 203: 116686535, 204: 116838059,
            205: 117444154, 206: 117747201, 207: 117898726, 208: 118353296, 209: 118656343,
            210: 118807868, 211: 119120332, 212: 119271871, 213: 119726482, 214: 120029557,
            215: 120181095, 216: 120484169, 217: 120787245, 218: 121090319, 219: 105899150,
            220: 106656837, 221: 106969019, 222: 107120569, 223: 107423670, 224: 107726771,
            225: 108332972, 226: 108484523, 227: 109242275, 228: 109545375, 229: 109696926,
            230: 110000026, 231: 110293284, 232: 110444820, 233: 110747894, 234: 111050968,
            235: 111657115, 236: 111808652, 237: 111960189, 238: 112263263, 239: 112414799,
            240: 112717873, 241: 113019510, 242: 113322580, 243: 113625650, 244: 113777185,
            245: 114080255, 246: 114080255, 247: 114231790, 248: 114231790, 249: 114383325,
            250: 114498509, 251: 114534860, 252: 114649996, 253: 114649996, 254: 114649996,
            255: 114649996, 256: 114649996, 257: 114649996, MAX_VAL: 114649996
        };

        function getExpForLevel(lvl) {
            const seasonKey = document.getElementById('seasonSelect').value;
            
            let table = expTableS1; 
            if (seasonKey === 'S2') table = expTableS2;
            if (seasonKey === 'S3') table = expTableS3;
            
            if (lvl < 100) return 0;
            
            const maxLvl = Math.max(...Object.keys(table).map(Number));
            if (lvl >= maxLvl) return table.MAX_VAL;
            
            return table[lvl] || table.MAX_VAL;
        }
        function getSmartExpValue(id) {
            const el = document.getElementById(id);
            if (!el || el.value === "") return 0;
            let val = Number(el.value);
            if (val > 0 && val < 300) { 
                return Math.round(val * 10000); 
            }
            return val;
        }

        const seasonConfig = {
            'S1': {
                baseLevel: 100,
                relicBaseLevel: 10,
                weights: { skill: 13, equip: 38, pal: 14, relic: 57 },
                starBase: 10,
                starDivisor: 100
            },
            'S2': {
                baseLevel: 130,
                relicBaseLevel: 13,
                weights: { skill: 7, equip: 18, pal: 8, relic: 33 },
                starBase: 45,
                starDivisor: 27
            },
            'S3': {
                baseLevel: 160,
                relicBaseLevel: 16,
                weights: { skill: 5, equip: 14, pal: 6, relic: 26 },
                starBase: 65,
                starDivisor: 13
            }
        };

        const allStarInputs = document.querySelectorAll('#tab-star input');
        allStarInputs.forEach(input => {
            input.addEventListener('input', calculateStar);
        });

        function handleSeasonChange() {
            calculateStar();
            calculateTime();
        }

        function calculateStar() {
            const seasonKey = document.getElementById('seasonSelect').value;
            const config = seasonConfig[seasonKey];

            const getVal = (id) => {
                const el = document.getElementById(id);
                return el.value === "" ? null : Number(el.value);
            };

            const charLevel = getVal('charLevel');
            let scoreLevel = (charLevel === null) ? 0 : Math.max(0, (charLevel - config.baseLevel)) * 100;
            
            const currentExp = getSmartExpValue('currentExp'); 
            let autoMaxExp = 0;
            if (charLevel !== null) {
                autoMaxExp = getExpForLevel(charLevel);
            }
            let scoreExp = (autoMaxExp > 0) ? Math.round((currentExp / autoMaxExp) * 100) : 0;

            const calcDetailedSum = (selector, base, weight) => {
                let sum = 0;
                document.querySelectorAll(selector).forEach(el => {
                    let val = el.value === "" ? 0 : Number(el.value);
                    sum += Math.max(0, (val - base)) * weight;
                });
                return sum;
            };

            const calcSimpleScore = (id, base, weightPerSlot, slotCount) => {
                const val = getVal(id);
                return (val === null) ? 0 : Math.max(0, (val - base)) * weightPerSlot * slotCount;
            };

            let scoreSkill = 0;
            if (document.getElementById('toggle-skill').checked) {
                scoreSkill = calcDetailedSum('.skill-detail', config.baseLevel, config.weights.skill);
            } else {
                scoreSkill = calcSimpleScore('avgSkill', config.baseLevel, config.weights.skill, 8);
            }

            let scoreEquip = 0;
            if (document.getElementById('toggle-equip').checked) {
                scoreEquip = calcDetailedSum('.equip-detail', config.baseLevel, config.weights.equip);
            } else {
                scoreEquip = calcSimpleScore('avgEquip', config.baseLevel, config.weights.equip, 5);
            }

            let scorePal = 0;
            if (document.getElementById('toggle-pal').checked) {
                scorePal = calcDetailedSum('.pal-detail', config.baseLevel, config.weights.pal);
            } else {
                scorePal = calcSimpleScore('avgPal', config.baseLevel, config.weights.pal, 4);
            }

            let scoreRelic = 0;
            if (document.getElementById('toggle-relic').checked) {
                scoreRelic = calcDetailedSum('.relic-detail', config.relicBaseLevel, config.weights.relic);
            } else {
                scoreRelic = calcSimpleScore('avgRelic', config.relicBaseLevel, config.weights.relic, 20);
            }

            const total = scoreLevel + scoreExp + scoreSkill + scoreEquip + scorePal + scoreRelic;
            // ÊòüÊòüË®àÁÆóÔºöBase + (Total / Divisor)
            const stars = config.starBase + (total / config.starDivisor);

            document.getElementById('star-totalScore').textContent = new Intl.NumberFormat().format(total);
            document.getElementById('star-final').textContent = stars.toFixed(2);
        }

        const expInputs = ['exp-currentLv', 'exp-targetLv', 'exp-currentExp', 'exp-perHour', 'exp-freeSpeedup', 'exp-stoneSpeedup'];
        expInputs.forEach(id => {
            const el = document.getElementById(id);
            if(el) el.addEventListener('input', calculateTime);
        });
        
        function formatTime(totalHours) {
            if (totalHours <= 0) return "0ÂàÜ";
            const days = Math.floor(totalHours / 24);
            const remainingHours = Math.floor(totalHours % 24);
            const minutes = Math.round((totalHours * 60) % 60);
            let timeString = "";
            if (days > 0) timeString += `${days}Â§© `;
            if (remainingHours > 0 || days > 0) timeString += `${remainingHours}Â∞èÊôÇ `;
            timeString += `${minutes}ÂàÜ`;
            return timeString;
        }

        function calculateTime() {
            const currentLv = Number(document.getElementById('exp-currentLv').value);
            const targetLv = Number(document.getElementById('exp-targetLv').value);
            const currentExp = getSmartExpValue('exp-currentExp');
            const expPerHour = Number(document.getElementById('exp-perHour').value) || 0;
            const freeSpeedup = Number(document.getElementById('exp-freeSpeedup').value) || 0;
            const stoneSpeedup = Number(document.getElementById('exp-stoneSpeedup').value) || 0;

            if (!currentLv || !targetLv || currentLv >= targetLv) {
                document.getElementById('exp-timeResult').textContent = "Ë´ãËº∏ÂÖ•Ê≠£Á¢∫Á≠âÁ¥öÁØÑÂúç";
                document.getElementById('exp-timeResult-original').textContent = "--";
                return;
            }

            let totalNeeded = 0;
            for (let lv = currentLv; lv < targetLv; lv++) {
                totalNeeded += getExpForLevel(lv); 
            }
            let baseRemainingNeeded = totalNeeded - currentExp;

            if (baseRemainingNeeded <= 0) {
                document.getElementById('exp-timeResult').textContent = "Â∑≤ÈÅîÊàêÁõÆÊ®ôÔºÅ";
                document.getElementById('exp-timeResult-original').textContent = "Â∑≤ÈÅîÊàêÁõÆÊ®ôÔºÅ";
                return;
            }

            if (expPerHour <= 0) {
                document.getElementById('exp-timeResult').textContent = "Ë´ãËº∏ÂÖ•ÊØèÂ∞èÊôÇÁ∂ìÈ©ó";
                document.getElementById('exp-timeResult-original').textContent = "Ë´ãËº∏ÂÖ•ÊØèÂ∞èÊôÇÁ∂ìÈ©ó";
                return;
            }

            const baseHoursNeeded = baseRemainingNeeded / expPerHour;
            document.getElementById('exp-timeResult-original').textContent = formatTime(baseHoursNeeded);

            const speedupHours = (freeSpeedup + stoneSpeedup) * 2;
            const speedupExp = speedupHours * expPerHour;
            let actualRemainingNeeded = baseRemainingNeeded - speedupExp;

            if (actualRemainingNeeded <= 0) {
                document.getElementById('exp-timeResult').textContent = "Âä†ÈÄüÂæåÂèØÁ´ãÂç≥ÈÅîÊàêÔºÅ";
                return;
            }

            const actualHoursNeeded = actualRemainingNeeded / expPerHour;
            document.getElementById('exp-timeResult').textContent = formatTime(actualHoursNeeded);
        }
    </script>
</body>
</html>
